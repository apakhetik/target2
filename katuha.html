<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°–ü–ï–®–õ –§–†–û–ú –ö–ê–¢–Æ–•–ê</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="header">
      <div class="left-head">
        <img src="./logo.png" alt="" class="logo" />
      </div>
      <div class="center-head">
        <a href="./index.html" class="link-head" id="show-target">–¢–∞—Ä–≥–µ—Ç</a>
        <a href="./index.html" class="link-head" id="show-serts">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã</a>
        <a href="katuha.html" class="link-head">–ö–ê–¢–Æ–•–ê</a>
      </div>
    </div>
    <div class="katuha-cont">
      <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–æ–º –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π</h1>
      <p>–î–ª—è –∫–∞—Ç—é—Ö–∏ üíï</p>
      <div class="imgkat">
        <img src="a.png" alt="" class="katuh" />
        <img src="a.png" alt="" class="katuh" />
        <img src="a.png" alt="" class="katuh" />
      </div>
      <h3>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞</h3>
      <div class="file-upload">
        <input type="file" id="excelFileInputOriginal" accept=".xlsx, .xls" />
        <label for="excelFileInputOriginal" class="file-upload-label"
          >–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</label
        >
      </div>

      <h3>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–µ—Å—Ç—Ä–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h3>
      <div class="file-upload">
        <input type="file" id="excelFileInputRemote" accept=".xlsx, .xls" />
        <label for="excelFileInputRemote" class="file-upload-label"
          >–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</label
        >
        <script>
          function playSound() {
            const sound = document.getElementById("clickSound");
            sound.play();
          }
        </script>
      </div>
      <h3>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—á–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞</h3>
      <div class="viberite">
        <input
          type="text"
          id="attendeeName"
          placeholder="–§–ò–û —É—á–∞—Å—Ç–Ω–∏–∫–∞"
          required />
        <input
          type="text"
          id="attendeeCompany"
          placeholder="–ö–æ–º–ø–∞–Ω–∏—è"
          required />
        <input type="email" id="attendeeEmail" placeholder="Email" required />
        <select id="ticketType" required>
          <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –±–∏–ª–µ—Ç–∞</option>
          <option value="–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π">–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π</option>
          <option value="—Å—Ç–∞–Ω–¥–∞—Ä—Ç">–°—Ç–∞–Ω–¥–∞—Ä—Ç</option>
        </select>
        <button onclick="addAttendee()">–î–æ–±–∞–≤–∏—Ç—å –æ—á–Ω–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞</button>
      </div>

      <button class="download-btn" onclick="exportTableToExcel()">
        –°–∫–∞—á–∞—Ç—å —Ä–µ–µ—Å—Ç—Ä
      </button>
      <script>
        function exportTableToExcel() {
          const allAttendees = [];
          const attendeesToDrop = [];

          // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
          remoteRegistry.forEach(remoteAttendee => {
            allAttendees.push({
              "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞": remoteAttendee.fullName,
              –ö–æ–º–ø–∞–Ω–∏—è: remoteAttendee.company,
              Email: remoteAttendee.email,
              "–¢–∏–ø –±–∏–ª–µ—Ç–∞": "–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–π",
              –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ: "–î–∞",
              –°—Ç–∞—Ç—É—Å: remoteAttendee.status,
              –¢–µ–ª–µ—Ñ–æ–Ω: remoteAttendee.number,
              –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: remoteAttendee.otvet,
              –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: remoteAttendee.komm,
              "–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª": remoteAttendee.ktoreg,
              "–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω": remoteAttendee.regwhen,
              –î–æ–≥–æ–≤–æ—Ä: remoteAttendee.dogovor,
              "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É": remoteAttendee.kommdog,
            });
          });

          console.log("–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã:", allAttendees);

          // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—á–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
          originalRegistry.forEach(originalAttendee => {
            if (originalAttendee.present) {
              allAttendees.push({
                –ö–æ–º–ø–∞–Ω–∏—è: originalAttendee.company,
                "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞": originalAttendee.name,
                –°—É–º–º–∞: originalAttendee.summa,
                Email: originalAttendee.email,
                "–¢–∏–ø –±–∏–ª–µ—Ç–∞": originalAttendee.ticketType,
                –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ: "–î–∞",
                –°—Ç–∞—Ç—É—Å: originalAttendee.status,
                –¢–µ–ª–µ—Ñ–æ–Ω: originalAttendee.number,
                –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: originalAttendee.otvet,
                –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: originalAttendee.komm,
                "–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª": originalAttendee.ktoreg,
                "–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω": originalAttendee.regwhen,
                –î–æ–≥–æ–≤–æ—Ä: originalAttendee.dogovor,
                "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É": originalAttendee.kommdog,
              });
            } else {
              attendeesToDrop.push({
                –ö–æ–º–ø–∞–Ω–∏—è: originalAttendee.company,
                "–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞": originalAttendee.name,
                –°—É–º–º–∞: originalAttendee.summa,
                Email: originalAttendee.email,
                "–¢–∏–ø –±–∏–ª–µ—Ç–∞": originalAttendee.ticketType,
                –°—Ç–∞—Ç—É—Å: originalAttendee.status,
                –¢–µ–ª–µ—Ñ–æ–Ω: originalAttendee.number,
                –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π: originalAttendee.otvet,
                –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: originalAttendee.komm,
                "–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª": originalAttendee.ktoreg,
                "–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω": originalAttendee.regwhen,
                –î–æ–≥–æ–≤–æ—Ä: originalAttendee.dogovor,
                "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É": originalAttendee.kommdog,
              });
            }
          });

          console.log("–û—á–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã:", allAttendees);
          console.log("–û—á–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –±–µ–∑ –≥–∞–ª–æ—á–∫–∏ (–æ—Ç–≤–∞–ª):", attendeesToDrop);

          const allWorksheet = XLSX.utils.json_to_sheet(allAttendees);
          const dropWorksheet = XLSX.utils.json_to_sheet(attendeesToDrop);

          // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏—Ä–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤
          const columnWidths = {
            A: { wpx: 200 }, // –§–ò–û
            B: { wpx: 250 }, // –ö–æ–º–ø–∞–Ω–∏—è
            C: { wpx: 250 }, // Email
            D: { wpx: 150 }, // –¢–∏–ø –±–∏–ª–µ—Ç–∞
            E: { wpx: 100 }, // –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ
            F: { wpx: 100 },
            G: { wpx: 100 },
          };

          allWorksheet["!cols"] = Object.values(columnWidths);
          dropWorksheet["!cols"] = Object.values(columnWidths);

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(
            workbook,
            allWorksheet,
            "–û–±—â–∏–π —Ä–µ–µ—Å—Ç—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"
          );
          XLSX.utils.book_append_sheet(workbook, dropWorksheet, "–û—Ç–≤–∞–ª");

          XLSX.writeFile(workbook, "—Ä–µ–µ—Å—Ç—Ä_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.xlsx");
        }
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
      <script>
        let originalRegistry = []; // –ò–∑–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä
        let remoteRegistry = []; // –î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        document
          .getElementById("excelFileInputRemote")
          .addEventListener("change", handleRemoteFile);

        function addAttendee() {
          const name = document.getElementById("attendeeName").value;
          const company = document.getElementById("attendeeCompany").value;
          const email = document.getElementById("attendeeEmail").value;
          const ticketType = document.getElementById("ticketType").value;

          if (name && company && email && ticketType) {
            const attendee = {
              name: name,
              company: company,
              email: email,
              ticketType: ticketType, // –£–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –±–∏–ª–µ—Ç–∞
              present: false, // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            };

            // –î–æ–±–∞–≤–ª—è–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ —Ä–µ–µ—Å—Ç—Ä
            originalRegistry.push(attendee);
            console.log("–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —É—á–∞—Å—Ç–Ω–∏–∫:", attendee);

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            updateOriginalTable();

            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
            document.getElementById("attendeeName").value = "";
            document.getElementById("attendeeCompany").value = "";
            document.getElementById("attendeeEmail").value = "";
            document.getElementById("ticketType").selectedIndex = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –±–∏–ª–µ—Ç–∞
          } else {
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.");
          }
        }

        function handleRemoteFile(event) {
          const file = event.target.files[0];

          if (!file) {
            console.error("–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω.");
            return;
          }

          const reader = new FileReader();
          reader.onload = function (e) {
            try {
              const data = new Uint8Array(e.target.result);
              const workbook = XLSX.read(data, { type: "array" });
              const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
              const jsonData = XLSX.utils.sheet_to_json(firstSheet);

              // Successfully processed the file
              document.getElementById("excelFileInputRemote").innerText =
                "–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!";
              remoteRegistry = jsonData
                .filter(row => row["–ò–º—è"] && row["–§–∞–º–∏–ª–∏—è"])
                .map(row => ({
                  company: row["–ö–æ–º–ø–∞–Ω–∏—è"] || "",
                  fullName: row["–ò–º—è"].trim() + " " + row["–§–∞–º–∏–ª–∏—è"].trim(),
                  summa: row["–°—É–º–º–∞"] || "",
                  status: row["–°—Ç–∞—Ç—É—Å"] || "",
                  email: row["Email"] || "",
                  number: row["–¢–µ–ª–µ—Ñ–æ–Ω"] || "",
                  otvet: row["–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π"] || "",
                  komm: row["–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"] || "",
                  ktoreg: row["–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª"] || "",
                  regwhen: row["–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"] || "",
                  dogovor: row["–î–æ–≥–æ–≤–æ—Ä"] || "",
                  kommdog: row["–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É"] || "",
                }));

              updateRemoteTable();
            } catch (error) {
              console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞:", error);
              document.getElementById("excelFileInputRemote").innerText =
                "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞.";
            }
          };
          reader.readAsArrayBuffer(file);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
        function updateRemoteTable() {
          const tableBody = document
            .getElementById("attendeeTable")
            .getElementsByTagName("tbody")[0];

          // –î–æ–±–∞–≤–ª—è–µ–º –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É
          remoteRegistry.forEach(function (attendee) {
            const row = tableBody.insertRow();
            row.insertCell(0).textContent = attendee.company; // –ö–æ–º–ø–∞–Ω–∏—è
            row.insertCell(1).textContent = attendee.fullName; // –§–ò–û
            row.insertCell(2).textContent = attendee.email; // Email
            row.insertCell(3).textContent = "–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–π"; // –£–∫–∞–∑—ã–≤–∞–µ–º —Ç–∏–ø –±–∏–ª–µ—Ç–∞

            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–∏–∫–ª –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —è—á–µ–µ–∫ –∑–Ω–∞—á–µ–Ω–∏–µ–º "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è"
            for (let i = 4; i <= 13; i++) {
              row.insertCell(i).textContent = "–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è";
            }
          });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞
        document
          .getElementById("excelFileInputOriginal")
          .addEventListener("change", handleOriginalFile);

        function handleOriginalFile(event) {
          const file = event.target.files[0];

          if (!file) {
            console.error("–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω.");
            return;
          }

          const reader = new FileReader();
          reader.onload = function (e) {
            try {
              const data = new Uint8Array(e.target.result);
              const workbook = XLSX.read(data, { type: "array" });
              const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
              const jsonData = XLSX.utils.sheet_to_json(firstSheet);

              console.log(
                "–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω. –î–∞–Ω–Ω—ã–µ:",
                jsonData
              );

              // –§–∏–ª—å—Ç—Ä—É–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ —Ç–∏–ø—É –±–∏–ª–µ—Ç–∞ "–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π" –∏–ª–∏ "–°—Ç–∞–Ω–¥–∞—Ä—Ç"
              originalRegistry = jsonData
                .filter(row => {
                  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±—Ü–µ "–ë–∏–ª–µ—Ç"
                  const ticketType = row["–ë–∏–ª–µ—Ç"];
                  return (
                    ticketType &&
                    (ticketType.toLowerCase() === "–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π" ||
                      ticketType.toLowerCase() === "—Å—Ç–∞–Ω–¥–∞—Ä—Ç")
                  );
                })
                .map(function (row) {
                  return {
                    company: row["–ö–æ–º–ø–∞–Ω–∏—è"],
                    name: row["–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞"], // –§–ò–û —É—á–∞—Å—Ç–Ω–∏–∫–∞
                    summa: row["–°—É–º–º–∞"],
                    email: row["Email"],
                    ticketType: row["–ë–∏–ª–µ—Ç"],
                    status: row["–°—Ç–∞—Ç—É—Å"],
                    present: false, // –§–ª–∞–≥ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
                    number: row["–¢–µ–ª–µ—Ñ–æ–Ω"],
                    otvet: row["–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π"],
                    komm: row["–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"],
                    ktoreg: row["–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª"],
                    regwhen: row["–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω"],
                    dogovor: row["–î–æ–≥–æ–≤–æ—Ä"],
                    kommdog: row["–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É"],
                  };
                });

              console.log(
                "–ò–∑–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä (—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π):",
                originalRegistry
              );
              updateOriginalTable(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—É
            } catch (error) {
              console.error(
                "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–µ–µ—Å—Ç—Ä–∞:",
                error
              );
            }
          };
          reader.onerror = function () {
            console.error("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞");
          };
          reader.readAsArrayBuffer(file);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
        function updateOriginalTable() {
          const tableBody = document
            .getElementById("attendeeTable")
            .getElementsByTagName("tbody")[0];

          // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü—É
          originalRegistry.forEach(function (attendee) {
            const row = tableBody.insertRow();
            row.insertCell(0).textContent = attendee.company;
            row.insertCell(1).textContent = attendee.name; // –§–ò–û // –ö–æ–º–ø–∞–Ω–∏—è
            row.insertCell(2).textContent = attendee.status; // —Å—Ç–∞—Ç—É—Å
            row.insertCell(3).textContent = attendee.ticketType; // –±–∏–ª–µ—Ç
            row.insertCell(4).textContent = attendee.summa; // —Å—É–º–º–∞
            row.insertCell(5).textContent = attendee.number; // —Å—É–º–º–∞
            row.insertCell(6).textContent = attendee.email; // Email
            row.insertCell(7).textContent = attendee.otvet;
            row.insertCell(8).textContent = attendee.komm;
            row.insertCell(9).textContent = attendee.ktoreg;

            row.insertCell(10).textContent = attendee.regwhen;
            row.insertCell(11).textContent = attendee.dogovor;
            row.insertCell(12).textContent = attendee.kommdog;
            // –î–æ–±–∞–≤–ª—è–µ–º —á–µ–∫–±–æ–∫—Å –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
            const presentCell = row.insertCell(13);
            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = attendee.present; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
            checkbox.addEventListener("change", function () {
              attendee.present = checkbox.checked; // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è
            });
            presentCell.appendChild(checkbox);
          });
        }
      </script>
    </div>
    <h3>–ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–µ—Å—Ç—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h3>
    <table id="attendeeTable" style="text-align: center">
      <thead>
        <tr>
          <th style="width: 100px">–ö–æ–º–ø–∞–Ω–∏—è</th>
          <th style="width: 100px">–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –∫–ª–∏–µ–Ω—Ç–∞</th>
          <th style="width: 100px">–°—Ç–∞—Ç—É—Å</th>
          <th style="width: 100px">–ë–∏–ª–µ—Ç</th>
          <th style="width: 50px">–°—É–º–º–∞</th>
          <th style="width: 100px">–¢–µ–ª–µ—Ñ–æ–Ω</th>
          <th style="width: 100px">Email</th>
          <th style="width: 100px">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</th>
          <th style="width: 100px">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
          <th style="width: 150px">–ö—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª</th>
          <th style="width: 30px">–ö–æ–≥–¥–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</th>
          <th style="width: 50px">–î–æ–≥–æ–≤–æ—Ä</th>
          <th style="width: 100px">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –¥–æ–≥–æ–≤–æ—Ä—É</th>
          <th style="width: 100px">–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ</th>
        </tr>
      </thead>
      <tbody>
        <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
      </tbody>
    </table>
  </body>
</html>
